const { Client, Message, MessageEmbed } = require("discord.js");

/**
 * A function to create send a help embed message
 * @param {Client} client - Your Discord Client
 * @param {Message} message - The Discord Message
 * @param {string} input - The command you are looking for
 * @param {string} prefix - Your bot's prefix
 * @returns {Message} Discord Message
 * @example cmdHelp(Client, Message, "ping", "?");
 */

function cmdHelp(client, message, input, prefix) {
    if (!client || !(client instanceof Client))
        throw new Error("[rayzdev] => \"client\" is a required parameter and must be a Discord Client!");
    
    if (!message || !(message instanceof Message))
        throw new Error("[rayzdev] => \"message\" is a required parameter and must be a Discord Message!");
    
    if (!prefix || typeof prefix !== "string")
        throw new Error("[rayzdev] => \"prefix\" is a required parameter and must be a String!");

    if (!client.commands)
        throw new Error("[rayzdev] => Failed to find your commands using \"client.commands\"");
    
    const cmd = client.commands.get(input.toLowerCase()) ||
        client.commands.get(client.aliases.get(input.toLowerCase()));


    if (!cmd) {
        return message.channel.send("", {
            embed: new MessageEmbed()
                .setColor("RED")
                .setDescription(`No information found for \`${input.toLowerCase()}\``)
                .setFooter(
                    `Commands: ${client.commands.size || 'Unknown'} | Prefix: ${prefix}`,
                    message.author.displayAvatarURL({ dynamic: true })
                )
        });
    }

    let info = `**Command Name:** \`${cmd.name || '-'}\`\n`;

    if (cmd.aliases)
        info += `**Aliases**: ${cmd.aliases.map((a) => `\`${a}\``).join(", ")}\n`;

    info +=
        `**Description:** \`${cmd.description || '-'}\`
        
        **Category**: \`${cmd.category || '-'}\`
        
        **Usage**: \`${prefix}${cmd.usage || cmd.name}\`
        **Usage Syntax**: \`<> = required, [] = optional\``;

    return message.channel.send("", {
        embed: new MessageEmbed()
            .setColor("BLUE")
            .setThumbnail(message.author.displayAvatarURL({ dynamic: true }))
            .setDescription(info)
            .setFooter(
                `Commands: ${client.commands.size || 'Unknown'} | Prefix: ${prefix}`,
                message.author.displayAvatarURL({ dynamic: true })
            )
    });
}

module.exports = cmdHelp;
